(()=>{function e(e){return e<1200?"#808080":e<1400?"#008000":e<1600?"#03a89e":e<1900?"#0000ff":e<2100?"#a0a":e<2400?"#ff8c00":e<3e3?"#ff0000":"#000000"}const t="codeforce-data";async function n(){let e=await chrome.storage.local.get(t);if(e=e[t],e&&function(e){const t=e.cacheTime,n=(Date.now()-t)/6e4;return console.log("Cache age: ",n),n<15}(e))return e.data;console.log("Fetching new data");const n=await fetch("https://codeforce-data-scrape-wo7a.vercel.app/api");let o=await n.json();return o=o.sort(((e,t)=>t.rating-e.rating)),await chrome.storage.local.set({[t]:{data:o,cacheTime:Date.now()}}),o}let o;o=async function(){let t=await n();const o=document.querySelector(".userbox");if(o){const n=o.querySelector("h1 > a").textContent;console.log(n);const a=t.find((e=>e["Codeforces*"]===n));a&&function(t){const n=document.querySelector(".info").querySelector("ul"),o=document.createElement("li"),a=`color: ${e(t)}; font-weight: bold;`;o.innerHTML=`\n    <img style="vertical-align:middle;margin-right:0.5em;" src="//codeforces.org/s/27736/images/icons/rating-24x24.png" alt="User''s contest rating in A2SV community" title="User''s contest rating in A2SV community">\n    A2SV Contest rating: <span style=${a}>${t}</span>\n  `,n.insertBefore(o,n.firstChild)}(a.rating)}t=t.sort(((e,t)=>t.rating-e.rating)),t=t.slice(0,50);const a=document.createElement("div");a.classList.add("roundbox","sidebox","borderTopRound","top-contributed");const c=document.createElement("div");c.classList.add("caption","titled"),c.textContent="A2SV Contest Leaderboard",a.appendChild(c);const d=document.createElement("table");d.classList.add("rtable");const s=document.createElement("tbody");a.appendChild(d);const l=document.createElement("tr"),i=document.createElement("th");i.classList.add("left"),i.textContent="#",i.style.width="2.25em",l.appendChild(i);const r=document.createElement("th");r.textContent="Name",l.appendChild(r);const m=document.createElement("th");m.textContent="Rating",m.style.width="5em";const u=document.createElement("th");u.textContent="Gr.",u.style.width="3em",l.appendChild(m),l.appendChild(u),s.appendChild(l);const p=Math.ceil(t.length/10);let h=1;function C(){s.innerHTML="",s.appendChild(l);const n=10*(h-1),o=n+10;for(let a=n;a<o&&a<t.length;a++){const n=document.createElement("tr"),o=document.createElement("td");o.classList.add("left"),o.textContent=a+1,n.appendChild(o);const c=document.createElement("td"),d=document.createElement("a");d.textContent=t[a]["Codeforces*"],d.classList.add("rated-user");const l=e(t[a].rating);d.style.color=l,d.href=`https://codeforces.com/profile/${t[a]["Codeforces*"]}`,c.appendChild(d),n.appendChild(c);const i=document.createElement("td");i.textContent="G"+t[a].group;const r=document.createElement("td");r.textContent=t[a].rating,n.appendChild(r),n.appendChild(i),a%2==0&&(o.classList.add("dark"),c.classList.add("dark"),r.classList.add("dark"),i.classList.add("dark")),s.appendChild(n)}}C(),function e(){let t=document.querySelector(".pagination");t||(t=document.createElement("div"),t.classList.add("pagination")),t.innerHTML="",a.appendChild(t);const n=document.createElement("button");n.textContent="Previous",n.disabled=1===h,n.addEventListener("click",(()=>{h>1&&(h--,C(),e())})),t.appendChild(n);for(let n=1;n<=p;n++){const o=document.createElement("button");o.style.border="none",o.style.background="none",o.style.color=h===n?"#000":"#0000FF",o.style.cursor="pointer",o.style.outline="none",o.style.fontWeight=h!=n?"bold":"normal",o.textContent=n,o.disabled=h===n,o.addEventListener("click",(()=>{h=n,C(),e()})),t.appendChild(o)}const o=document.createElement("button");o.textContent="Next",o.disabled=h===p,o.addEventListener("click",(()=>{h<p&&(h++,C(),e())})),t.appendChild(o)}(),d.appendChild(s);const f=document.getElementById("sidebar");f.insertBefore(a,f.firstChild)}()})();